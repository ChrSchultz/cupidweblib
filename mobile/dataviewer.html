<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" >


    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />


    <title>CuPID Dataviewer</title>

    <script src="js/jquery-1.7.1.min.js"></script>
    <link rel="stylesheet" href="css/jquery.mobile-1.2.1.css" />
    <script src="js/jquery.mobile-1.2.1.js"></script>
    <link rel="stylesheet" href="css/jqm-docs.css" />
    <link rel="stylesheet" href="css/CuPID.css" />
    <script src="js/jqm-docs.js"></script>

    <script language="javascript" type="text/javascript" src="js/jqplot/jquery.jqplot.min.js"></script>
    <link rel="stylesheet" type="text/css" href="js/jqplot/jquery.jqplot.css" />
    <script type="text/javascript" src="js/jqplot/plugins/jqplot.canvasTextRenderer.min.js"></script>
    <script type="text/javascript" src="js/jqplot/plugins/jqplot.canvasAxisLabelRenderer.min.js"></script>
    <script type="text/javascript" src="js/jqplot/plugins/jqplot.dateAxisRenderer.js"></script>
    <script type="text/javascript" src="js/jqplot/plugins/jqplot.cursor.min.js"></script>

    <script src="/js/iijslib.js" type="text/javascript"></script>
    <script src="/js/cupidjslib.js" type="text/javascript"></script>
</head>
<body>

<div data-role="page" class="type-home" id="main">
<script>

// Define our usr for access control of features:


// Set objects. not used yet.
//var plotdefs = new plotdefs()
//plotdefs.plotids=[]
//plotdefs.series=[[[]]]
//plotdefs.plotids.push('myplotid')
//plotdefs.series.push([[['/var/www/data/controldata.db','channels','channel 1data']]])

// define some globals
var jqmpage=true;
var inputids=[];
var inputnames=[];
var inputgroups=[];
var channelsdata=[];
var channelnames=[];
var channellogdata=[];
var renderclassnames=[];

var updatetimeout=100;
var loginterval=30000;
var updateinterval=30000;

var setpointvalueseries=[];
var controlvalueseries=[];
var actionseries=[];

var actauthlevel=2;

//// Channels
function UpdateLogTable() {
    var callback=RenderLogs;
    var callbackoptions={}
    wsgiGetTableNames(logdatabase,callback,callbackoptions)
}
function RenderLogs(datatable) {

    $('#logdatalistview').empty()
    console.log(datatable)
    $('#logdatalistview').append('\
        <li data-role="list-divider">\
            <h4>Content Selection</h4>\
        </li>'
    )
    for (var i=0;i<datatable.length;i++){
        $('#logdatalistview').append('\
                <li data-role="fieldcontain" id="logdataset" >\
                    <p class="ui-block-a ui-biglabel" style="width: 100%">' + datatable[i] + '</p>\
                    <fieldset class="ui-grid-a" style="margin-top:40px">\
                        <div class="ui-block-a " style="text-align: left; margin-right: 0px; width:75%" >\
                            <label for="plotme" style="font-size:14px; margin-top: 1px; position: relative; top: -6px;  margin-left: 0px; margin-right: 5px">Plot</label>\
                            <select name="plotme" class="plotme" data-role="slider">\
                            <option value="Off">Off</option>\
                            <option value="On">On</option>\
                            </select>\
                        </div>\
                        <div class="ui-block-b ui-btn-up-d  ui-btn-corner-all cnt" style="float:right; margin:3px 1px 5px 0px; padding: 7px 10px; text-align: center; width: 60px">52\
                        </div>\
                    </fieldset>\
                </li>'
        )
    }
    $('#logdatalistview').listview('refresh')
    $('#logdatalistview').trigger("create")
}


$(document).ready(function(){
    togglestolamps()

    //// Control Algorithms
    // UpdateLogsTable({'timeout':updateinterval})
    $('#plotrefresh').click(function(event){
        //UpdateInputsTable()
        GetAndRenderLogData({logtablename:'input_i2c1wire_289E4FA804000011log','seriesnames':['value'],renderplotids:['plot'],renderplotoptions:[channelOptionsObj]})
    });
    UpdateLogTable()

});
</script>
<div data-role="content">
<div class="content-secondary">
    <ul data-role="listview" data-inset="true">
        <li data-role="list-divider"><h4>Plot Controls</h4></li>
        <li class="sm-inset-header">
            <label for="plotpointsslider" style="width:100%; padding-right:40px">Plot Points</label>
            <input type="range" id="plotpointsslider" class="plotpointsslider" value="55" min="0" max="100" />
        </li>
        <li class="sm-inset-header">
            <label for="plotpointsslider" style="width:100%; padding-right:40px">Update Frequency</label>
            <input type="range" id="plotpointsslider" class="plotpointsslider" value="55" min="0" max="100" />
        </li>
        <li data-role="fieldcontain">
            <a href="logviewer.html">Log Viewer</a>
        </li>
    </ul>
</div><!--/content-secondary-->
<div class="content-primary">
    <ul data-role="listview" data-inset="true" data-dividertheme="c" id="logdatalistview">
        <li data-role="list-divider">
            <h4>Content Selection</h4>
        </li>
        <li data-role="fieldcontain">
            &nbsp;
        </li>
    </ul>
    <div data-role="button" data-theme="c" id="plotrefresh">Refresh</div>
    <ul data-role="listview" data-inset="true" data-dividertheme="c" id="channellistview">
        <li data-role="list-divider">
            <h4>Data Plot</h4>
        </li>
        <li data-role="fieldcontain" >
            <div id="plot" class="plot"></div>
        </li>
    </ul>
</div><!--content-primary-->
</div><!--content-->
</div><!-- page -->
</body>
</html>
